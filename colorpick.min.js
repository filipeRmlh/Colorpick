let uuid=()=>Math.random().toString(36).substr(2,16);class Colorpick{constructor(container,value,displayType){let _this=this;this._applyThumbFilter=!0,this.container=container,this.content=document.createElement("div"),this.input=document.createElement("input"),this.radio=document.createElement("div");let idhex=uuid(),idhsl=uuid(),idrgb=uuid();return this.displayType=displayType||"hsl",this.value=value||[10,50,50],this.radio.innerHTML=`\n            <span style='display:inline'><label for='radio-${idhex}'>hex</label><input ${"hex"===this.displayType?"checked":""} id='radio-${idhex}' name='tipo' type='radio' value='hex'></span>\n            <span  style='display:inline'><label for='radio-${idhsl}'>hsl</label><input ${"hsl"===this.displayType?"checked":""} id='radio-${idhsl}' name='tipo' type='radio' value='hsl'></span>\n            <span  style='display:inline'><label for='radio-${idrgb}'>rgb</label><input ${"rgb"===this.displayType?"checked":""} id='radio-${idrgb}' name='tipo' type='radio' value='rgb'></span>\n        `,this.input.setAttribute("type","text"),this.hRange=new Range,this.sRange=new Range,this.lRange=new Range,this.setUpElements(),this.setUpEvents(),this.setRangesValues(this.value),this.setThumbsColors(),this.setInputColors(),this.setRangesColors(),this.setInputValue(),new Proxy(this,{set:(target,prop,val)=>_this._onChange(target,prop,val)})}_onChange(target,property,value){return target[property]=value,"value"==property&&this.setRangesValues(value),!0}setThumbsColors(){let lum=this.lRange.value<50?"invert(100%)":"";this.lRange.thumb.style.filter=lum,this.sRange.thumb.style.filter=lum,this.hRange.thumb.style.filter=lum}setInputValue(){let out=this.value=[Math.round(3.6*this.hRange.value),Math.round(this.sRange.value),Math.round(this.lRange.value)];switch(this.displayType){case"hex":out=Colors.hsl2hex(out);break;case"rgb":out=`rgb(${Colors.hsl2rgb(out)})`;break;default:out=`hsl(${out[0]}, ${out[1]}%, ${out[2]}%)`}this.input.value=out}setInputColors(){let h=this.hRange.value,s=this.sRange.value,l=this.lRange.value;this.input.style.color=l<50?"white":"black",this.input.style.backgroundColor=`hsl(${3.6*h}, ${s}%, ${l}%)`}matchRegex(val){let regexhsl=/hsl\(\s*(\d+)\s*,\s*(\d+(?:\.\d+)?)%\s*,\s*(\d+(?:\.\d+)?)%\)/,regexrgb=/rgb\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\)/,res=val.match(/^(\#?)([0-9a-fA-F]{6}|[0-9a-fA-F]{3})$/);return res?{value:res[2],tipo:"hex"}:(res=val.match(regexhsl))?{value:[parseInt(res[1]),parseInt(res[2]),parseInt(res[3])],tipo:"hsl"}:(res=val.match(regexrgb))?{value:[parseInt(res[1]),parseInt(res[2]),parseInt(res[3])],tipo:"rgb"}:{tipo:error,out:this.value}}inputChangeHandle(e){let val=this.input.value,out=this.matchRegex(val);switch(out.tipo){case"hsl":this.setRangesValues(out.value);break;case"rgb":this.setRangesValues(Colors.rgb2hsl(out.value));break;case"hex":this.setRangesValues(Colors.hex2hsl(out.value))}}setUpElements(){this.container.appendChild(this.content),this.content.appendChild(this.input),this.content.appendChild(this.hRange.track),this.content.appendChild(this.sRange.track),this.content.appendChild(this.lRange.track),this.content.appendChild(this.radio)}setRangesValues(hsl){this.hRange.value=hsl[0]/3.6,this.sRange.value=hsl[1],this.lRange.value=hsl[2]}setRangesColors(){let h=this.hRange,s=this.sRange,l=this.lRange;h.track.style=CssGradient.getCssHue(s.value,l.value),s.track.style=CssGradient.getCssSat(3.6*h.value,l.value),l.track.style=CssGradient.getCssLig(3.6*h.value,s.value)}hRangeChangeHandle(e){this.setInputColors(),this.setRangesColors(),this.setInputValue()}sRangeChangeHandle(e){this.setInputColors(),this.setRangesColors(),this.setInputValue()}lRangeChangeHandle(e){this.setInputColors(),this.setThumbsColors(),this.setRangesColors(),this.setInputValue()}changeType(e){this.displayType=e.target.value,this.setInputValue()}setUpEvents(){let _this=this;this.hRange.onChange=(e=>_this.hRangeChangeHandle(e)),this.sRange.onChange=(e=>_this.sRangeChangeHandle(e)),this.lRange.onChange=(e=>_this.lRangeChangeHandle(e)),this.input.addEventListener("change",e=>{_this.inputChangeHandle(e)}),this.content.querySelectorAll("[name=tipo]").forEach(elm=>{elm.addEventListener("change",e=>_this.changeType(e))})}}class Colors{static hsl2rgb(color){let r,g,b,h=color[0]/360,s=color[1]/100,l=color[2]/100;if(0==s)r=g=b=l;else{let hue2rgb=(p,q,t)=>(t<0&&(t+=1),t>1&&(t-=1),t<1/6?p+6*(q-p)*t:t<.5?q:t<2/3?p+(q-p)*(2/3-t)*6:p);var q=l<.5?l*(1+s):l+s-l*s,p=2*l-q;r=hue2rgb(p,q,h+1/3),g=hue2rgb(p,q,h),b=hue2rgb(p,q,h-1/3)}return[Math.round(255*r),Math.round(255*g),Math.round(255*b)]}static rgb2hsl(color){let r=color[0],g=color[1],b=color[2];r/=255,g/=255,b/=255;var h,s,max=Math.max(r,g,b),min=Math.min(r,g,b),l=(max+min)/2;if(max==min)h=s=0;else{var d=max-min;switch(s=l>.5?d/(2-max-min):d/(max+min),max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return[360*h,100*s,100*l]}static hex2rgb(color){let hex=(color+"").toLowerCase(),simple=!0;var re=/^#?([a-f\d]{1})([a-f\d]{1})([a-f\d]{1})/;hex.length>4&&(simple=!1,re=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})/);let result=[];return result[0]=hex.replace(re,"$1"),result[1]=hex.replace(re,"$2"),result[2]=hex.replace(re,"$3"),[parseInt(result[0]+(simple?result[0]:""),16),parseInt(result[1]+(simple?result[1]:""),16),parseInt(result[2]+(simple?result[2]:""),16)]}static rgb2hex(color){let toHex=x=>{let hex=Math.round(x).toString(16);return 1===hex.length?"0"+hex:hex};return"#"+toHex(color[0])+toHex(color[1])+toHex(color[2])}static hex2hsl(color){return Colors.rgb2hsl(Colors.hex2rgb(color))}static hsl2hex(color){return Colors.rgb2hex(Colors.hsl2rgb(color))}}class CssGradient{static getCssValuePrefix(){let prefixes=["","-webkit-","-ms-","-moz-","-o-"];for(let i=0;i<prefixes.length;i++){CssGradient.direction=0==i?"to right":"left";let suporte=CSS.supports("background",prefixes[i]+"linear-gradient("+CssGradient.direction+",hsl(0,0%,0%) 0%,hsl(0,0%,0%) 100%)");if(CssGradient.browserPrefix=prefixes[i],suporte)return}}static getCssBackground(){return"background-image: "+CssGradient.browserPrefix+"linear-gradient("+CssGradient.direction+", "}static getCssHue(s,l){var hue="hsl(0,"+s+"%,"+l+"%) 0%, hsl(61.2,"+s+"%,"+l+"%) 17%, hsl(118.8,"+s+"%,"+l+"%) 33%, hsl(180,"+s+"%,"+l+"%) 50%, hsl(241.2,"+s+"%,"+l+"%) 67%, hsl(298.8,"+s+"%,"+l+"%) 83%, hsl(0,"+s+"%,"+l+"%) 100%);";return CssGradient.getCssBackground()+hue}static getCssSat(h,l){return CssGradient.getCssBackground()+"hsl("+h+",0%,"+l+"%) 0%, hsl("+h+",100%,"+l+"%) 100%);"}static getCssLig(h,s){return CssGradient.getCssBackground()+"hsl("+h+","+s+"%,0%) 0%, hsl("+h+","+s+"%,50%) 50%, hsl("+h+","+s+"%,100%) 100%);"}}CssGradient.getCssValuePrefix();class Range{constructor(){let _this=this;return this.padding=7,this.pressed=!1,this.track=document.createElement("div"),this.track.setAttribute("class","range"),this.thumb=document.createElement("span"),this.track.appendChild(this.thumb),this.onChange=(()=>{}),this.value=50,this.thumb.style.left="50%",this._setupEvents(),new Proxy(this,{set:(target,prop,val)=>_this._onChange(target,prop,val)})}_setupEvents(){let _this=this;this.track.addEventListener("mousedown",e=>_this.trackStart(e)),this.track.addEventListener("touchstart",e=>_this.trackStart(e)),document.addEventListener("mousemove",e=>_this.trackMove(e)),document.addEventListener("touchmove",e=>_this.trackMove(e)),document.addEventListener("touchend",e=>_this.trackEnd(e)),document.addEventListener("mouseup",e=>_this.trackEnd(e))}getRelativePosition(elm,pos){let posStartElm=elm.getBoundingClientRect().left,widthElm=elm.offsetWidth;return{withPadding:100*(pos-posStartElm-this.padding)/(widthElm-2*this.padding-1),withoutPadding:100*(pos-posStartElm)/(widthElm-1)}}getAbsolutePosition(elm,percent){let posStartElm=elm.getBoundingClientRect().left,widthElm=elm.offsetWidth;return{withPadding:percent*(widthElm-2*this.padding-1)/100+posStartElm+this.padding,withoutPadding:percent*(widthElm-1)/100+posStartElm}}trackStart(e){return this.pressed=!0,this.setThumbPos(e),!1}trackMove(e){return this.pressed&&this.setThumbPos(e),!1}trackEnd(e){return this.pressed=!1,!1}_onChange(target,property,value){if(target[property]=value,"value"==property){let e={pageX:this.getAbsolutePosition(this.track,value).withPadding};target.setThumbPos(e)}return!0}setThumbPos(e){let pos=this.getRelativePosition(this.track,e.pageX||e.changedTouches[0].pageX);pos.withPadding<=100&&pos.withPadding>=0?(this.thumb.style.left=pos.withoutPadding+"%",this.value=pos.withPadding,this.onChange(e)):(pos=pos.withPadding>100?this.getRelativePosition(this.track,this.getAbsolutePosition(this.track,100).withPadding):this.getRelativePosition(this.track,this.getAbsolutePosition(this.track,0).withPadding),this.thumb.style.left=pos.withoutPadding+"%",this.value=pos.withPadding)}}